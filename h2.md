# h2 Break & unbreak
Tehtävänä oli muutaman eri artikkelin tiivistäminen.
## A01:2021 – Broken Access Control
-	Access control eli pääsyn hallinta pitää huolen siitä, että käyttäjä ei voi toimia oikeuksiensa ulkopuolella. Käyttöoikeuksien kanssa tapahtuvat virheet tai huonot käytännöt voivat johtaa oikeudettoman henkilön pääsyyn datan lukemiseen, tuhoamiseen tai muokkaamiseen.

-	Tyypillisiä pääsyn hallinnan heikkouksia ovat mm. 
- Käyttöoikeuksien pitäminen mahdollisimman pienenä käyttäjille ja käyttäjäryhmille.
- Käyttöoikeuksien kiertäminen URL:ia tai HTML-sivua muuttamalla tai API-pyyntöjä muuttavalla hyökkäystyökalulla.
- Tietojen muokkaamiseen tai katsomiseen pääsy yksilöllisellä tunnuksella (unique identifier).
- API:n käyttö puuttuvilla oikeuksilla POST-, PUT-, ja DELETE-komennoille.
- Käyttöoikeuksien laajentaminen: pääsy userin oikeuksiin ilman kirjautumista tai userilla kirjautuneella admin-oikeudet.

-	Käyttöoikeuksien hallinta on toimivaa ainoastaan luotetussa serveripuolen koodissa, sekä serverittömissä API:issa, joissa käyttäjä ei voi muokata käyttöoikeuksien tarkastusta tai metadataa.

-	Tapoja estää haavoittuvuuksia:
- Jos resurssi ei ole julkinen, kiellä pääsy oletusarvona.
- Luo ja ota käyttöoikeuksien hallinta käyttöön ja käytä sitä koko ohjelmistossa, minimoi eri verkkolähteiden resurssien jakaminen (CORS).
- Varmista, että metadata ja varmuuskopiot eivät ole suoraan saatavilla juurihakemistosta.
- Pidä logia käyttöoikeuksien hallinnan virheistä, toistuvista tapauksista tieto admineille.
- Rajoita pyyntömäärää joita saa suorittaa estääksesi hyökkäyksiä automatisoiduilta työkaluilta. 
(OWASP)

## Find Hidden Web Directories - Fuzz URLs with ffuf
-	Webbipalvelimilla on yleensä salaisia hakemistoja, jotka eivät ole linkitettyinä missään.

-	Näitä voi yrittää etsiä manuaalisesti kokeilemalla erilaisia tiedostopolkuja, kuten /secret tai /admin.


-	Ffuf voi tehdä etsimisen automaattisesti, sillä se on työkalu, jonka joohoi on kehittänyt fuzz-testaamaan hakemistoja, headereita, POST-parametreja jne. 

-	Ennen tällaisen työkalun käyttöä on otettava selvää toiminnan laillisuudesta sekä eettisyydestä.


-	Koska ffuf on erittäin nopea työkalu, tulee ennen käyttöä kytkeytyä pois verkosta, jotta paketteja ei turhaan vuoda julkiseen internetiin.
(Karvinen)

## Access control vulnerabilities and privilege escalation
-	Käytön hallinta tarkoittaa erilaisia rajoituksia, joita asetetaan sille, kuka saa käyttää mitäkin resursseja ja millä tavalla.

-	Web-applikaatioissa käyttöoikeuksien hallinta riippuu käyttäjän todennuksesta sekä istunnon hallitsemisesta.

-	Todennuksella varmistetaan käyttäjän olevan oikea.

-	Istunnon hallitsemisella tarkastetaan, mitkä tulevat http-pyynnöt tulevat samalta käyttäjältä.

-	Käyttöoikeuksien hallinnalla varmistetaan, että käyttäjällä on oikeus suorittaa yrittämiään pyyntöjä.

-	Käyttöoikeuksien hallinnan ongelmat ovat yleisiä ja johtavat usein kriittisiin tietoturvahaavoittuvuuksiin. 

-	Vertikaalinen käytön hallinta estää tiettyjen toimintojen suorittamisen tietyiltä käyttäjäryhmiltä, esimerkiksi user vs admin.

-	Horisontaalinen käytön hallinta sallii pääsyn resursseihin tietylle käyttäjälle, esimerkiksi pankin asiakas pääsee käsiksi vain oman tilinsä tietoihin.

-	Kontekstista riippuva käytön hallinta estää tiettyjen toiminnallisuuksien ja resurssien käytön sovelluksen tilasta ja käyttäjän tekemistä toimista riippuen. Tällä estetään esimerkiksi nettikaupan ostoskorin muokkaaminen maksun jälkeen.

-	Esimerkkejä rikkonaisesta käyttöoikeuksien hallinnasta:
- Käyttäjän pääsy toiminnallisuuksiin, joihin hänellä ei ole käyttöoikeuksia, kuten käyttäjien poisto userina (vertikaalinen käytön hallinta).
- Suojaamattomat toiminnallisuudet, kuten admin-toimintoihin pääsy oikean hakemistopolun arvaamisella/selvittämisellä.
- Parametreihin perustuvat käyttöoikeudet: applikaatio voi tarkastaa käyttöoikeudet käyttäjän kirjautuessa sisään, ja tallentaa tämän tiedon joko cookieen, piilotettuun kenttään tai ennalta määriteltyyn stringiin. Tämä on huono metodi, sillä käyttäjä voi päästä muokkaamaan näitä parametrejä ja näin päästä käsiksi häneltä kiellettyihin resursseihin.
- Sijaintiin perustuva käytön hallinta: helppo kiertää käyttämällä esimerkiksi VPN:ää.

-	Tapoja estää käytön hallinnan heikkouksia:
- Älä luota ainoastaan asioiden vaikeatajuistamiseen.
- Jos resurssi ei ole julkinen, kiellä käyttö oletusarvoisesti.
- Käytä yhtä sovelluksen laajuista metodia aina kun se on mahdollista.
- Varmista, että sovelluskehittäjät määrittävät oikeat käyttöoikeudet jokaiselle resurssille ja että oletusarvoisesti käyttö kielletään.
- Testaa ja auditoi käyttöoikeuksien hallintaa varmistaaksesi niiden toimimisen.
(PortSwigger)

## Raportin kirjoittaminen
Olen jo aiemmalla kurssilla tiivistänyt raportointiohjeet, ja lainaan tässä kohdassa tätä omaa tiivistelmääni, joka löytyy omasta GitHubistani (https://github.com/Essberg/linux-course/blob/main/h1-installing-debian.md).

Karvinen, T. (2024) ohjeistaa raportoimaan hyviä käytäntöjä noudattaen:

- Raportoidessa kerrot tarkkaan mitä teet ja mitä tapahtui.
- Käytä imperfektiä.
- Raporttia kannattaa kirjoittaa heti tehdessä sähköiseen muotoon.
- Raportissa olevat tulokset on pystyttävä toistamaan.
- Käytä aikaleimoja, mainitse oma käyttöympäristösi.
- Kuvaa tekemisesi tarkoin: mitä komentoa käytit, minkä virheviestin sait, millä todensit tehtävän epäonnistuneen, missä ohjelmassa virhe tapahtui.
- Käytä huolellista ja helppolukuista tekstiä.
- Muista viitata lähteisiin.

(Karvinen)
